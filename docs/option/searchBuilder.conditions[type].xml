<?xml version="1.0" encoding="UTF-8" ?>
<dt-option library="SearchBuilder">
	<name>searchBuilder.conditions[type]</name>
	<summary>The object structure for additional conditions for SearchBuilder</summary>
	<since>SearchBuilder 0.0.1</since>

	<type type="Array">
		<description>
            An array of objects that contain the information necessary to add a new condition.
        </description>
	</type>

	<default value="Array">

	</default>
	<description>
		<![CDATA[
		This is useful as it allows custom conditions to be added to SearchBuilder should the standard ones not be enough.

        This object contains 5 properties.

        * `-init searchBuilder.conditions[type].conditionName` The string that is to be displayed in the option for this condition. Also what it is referred to throughout.
        * `-init searchBuilder.conditions[type].init` This function is used to initialise the vlaue element
        * `-init searchBuilder.conditions[type].inputValue` This function is used to return the value that the values from the table should be compared against
        * `-init searchBuilder.conditions[type].isInputValid` This function is used to determine if the criteria should be used in the overall filter
        * `-init searchBuilder.conditions[type].search` This is the function that compares the row data and the value selected in this criteria.

        The custom condition defined in the example will override the `=` condition in the `-type num` condition set.

        More details on the structure that is used can be found at `-init searchBuilder[type]`
        ]]>
	</description>

	<example title="Simple extra num condition"><![CDATA[

    var dt = $('#example').DataTable( {
        dom: 'Qfrtip',
        searchBuilder: {
            conditions: {
                "num":{
                    '=': {
                        isInputValid: function (el, that) {
                            $(that.dom.valueTitle).attr('selected', false);
                            let allFilled = true;

                            for (let element of el) {
                                if ($(element).has('option:selected').length < 1) {
                                    allFilled = false;
                                }
                            }

                            return allFilled;
                        }
                        conditionName: 'Made up',
                        inputValue: function (el, value = null) {
                            let values = [];

                            if (value === null) {
                                for (let element of el) {
                                    if ($(element).is('select')) {
                                        values.push($(element).children('option:selected').val());
                                    }
                                }
                            }
                            else {
                                for (let v = 0; v < el.length; v ++) {
                                    if ($(el[v]).is('select')) {
                                        let children = $(el[v]).children().toArray;
                                        for (let child of children) {
                                            if ($(child).val() === value[v]) {
                                                $(child).attr('selected', true);
                                                values.push(value[v]);
                                            }
                                        }
                                    }
                                }
                            }

                            return values;
                        },
                        init: function (that, fn, preDefined) {
                            let column = $(that.dom.data).children('option:selected').val();
                            let indexArray = that.s.dt.rows().indexes().toArray();
                            let settings = that.s.dt.settings()[0];

                            let el = $('<select/>').append(that.dom.valueTitle);
                            el.on('change', function() {fn(that, el)});

                            that.s.values = [];

                            for (let index of indexArray) {
                                let filter = settings.oApi._fnGetCellData(settings, index, column, that.c.orthogonal.search);

                                let value = {
                                    filter,
                                    index,
                                    text: settings.oApi._fnGetCellData(settings, index, column, that.c.orthogonal.conditionName)
                                };
                                that.s.values.push(value);
                                let opt = $('<option>', {
                                    text : that.s.type.includes('html') ? value.text.replace(/(<([^>]+)>)/ig, '') : value.text,
                                    value : that.s.type.includes('html') ? value.filter.replace(/(<([^>]+)>)/ig, '') : value.filter
                                })
                                .addClass(that.classes.option)
                                .addClass(that.classes.notItalic);
                                $(el).append(opt);
                                if (preDefined !== null && opt.val() === preDefined[0]) {
                                    opt.attr('selected', true);
                                    that.dom.valueTitle.remove();
                                }
                            }

                            return el;
                        },
                        search: function (value, comparison) {
                            return +value === +comparison[0];
                        }
                    }
                }]
            }
        }
    });

]]></example>

<related type="init">searchBuilder.conditions</related>
<related type="init">searchBuilder.conditions[type].isInputValid</related>
<related type="init">searchBuilder.conditions[type].search</related>
<related type="init">searchBuilder.conditions[type].conditionName</related>
<related type="init">searchBuilder.conditions[type].inputValue</related>
<related type="init">searchBuilder.conditions[type].init</related>

</dt-option>
